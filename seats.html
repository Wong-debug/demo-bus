<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-translate="selectSeat">Select Your Seat - BotsQuick</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Clean seat layout */
        .trip-summary {
            background: #f0f0f0;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: monospace;
        }

        .trip-summary p {
            margin: 5px 0;
            font-size: 14px;
        }

        .bus-layout-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }

        .bus-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            padding: 10px;
            background: #eee;
            border-radius: 5px;
        }

        .driver-area {
            text-align: center;
            padding: 10px;
            background: #333;
            color: white;
            border-radius: 5px;
            margin-bottom: 20px;
            width: 80px;
            margin-left: auto;
            margin-right: auto;
        }

        .seats-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-family: monospace;
        }

        .seat-row {
            display: flex;
            justify-content: center;
            gap: 8px;
        }

        .seat-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.1s ease;
        }

        .seat-number.available {
            background: white;
            border-color: #4CAF50;
            color: #333;
        }

        .seat-number.available:hover {
            background: #e8f5e8;
        }

        .seat-number.selected {
            background: #75AADB;
            border-color: #75AADB;
            color: white;
        }

        .seat-number.occupied {
            background: #ffebee;
            border-color: #F44336;
            color: #c62828;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .back-row {
            margin-top: 20px;
            border-top: 2px dashed #ccc;
            padding-top: 20px;
        }

        .back-row-label {
            text-align: center;
            color: #999;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .back-row .seat-number {
            width: 45px;
            height: 45px;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 20px 0;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .legend-box {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .legend-box.available {
            background: white;
            border: 2px solid #4CAF50;
        }

        .legend-box.selected {
            background: #75AADB;
        }

        .legend-box.occupied {
            background: #ffebee;
            border: 2px solid #F44336;
        }

        .selected-count {
            background: #75AADB;
            color: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
        }

        .seat-numbers-reference {
            font-family: monospace;
            background: #f9f9f9;
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
            font-size: 12px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 data-translate="selectSeat">Select Your Seat</h1>
            <p data-translate="choosePreferred">Click seats to select (click again to deselect)</p>
        </header>

        <main class="main-content">
            <div class="card">
                <!-- Trip Summary (like your image) -->
                <div class="trip-summary">
                    <h3>ðŸ“‹ Trip Summary</h3>
                    <p>Route: <span id="route-display">francistown â†’ francistown</span></p>
                    <p>Date: <span id="date-display">2026-02-18</span></p>
                    <p>Time: <span id="time-display">10:00</span></p>
                </div>

                <!-- Bus Layout -->
                <div class="bus-layout-container">
                    <div class="bus-header">ðŸšŒ BUS LAYOUT</div>
                    
                    <!-- Driver -->
                    <div class="driver-area">DRIVER</div>

                    <!-- Seats Grid -->
                    <div class="seats-grid" id="seats-container">
                        <!-- Seats will be generated here -->
                    </div>

                    <!-- Legend -->
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-box available"></div>
                            <span>Available</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-box selected"></div>
                            <span>Selected</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-box occupied"></div>
                            <span>Occupied</span>
                        </div>
                    </div>

                    <!-- Seat reference (like your image bottom row) -->
                    <div class="seat-numbers-reference">
                        Click any seat to select â€¢ Selected seats turn blue â€¢ Click again to deselect
                    </div>
                </div>

                <!-- Selection Summary -->
                <div class="selected-count" id="selection-summary">
                    Selected: 0 seats | Total: 0 BWP
                </div>

                <div class="button-group">
                    <button onclick="proceedToPayment()" class="btn-primary" id="proceed-btn" disabled>
                        Continue to Payment
                    </button>
                    <a href="booking.html" class="btn-secondary" data-translate="back">Back</a>
                </div>
            </div>
        </main>
    </div>

    <script src="lang-config.js"></script>
    <script>
        let selectedSeats = new Set();
        const pricePerSeat = 120;
        
        // Occupied seats (for demo)
        const occupiedSeats = [3, 7, 12, 15, 18, 22, 25, 28, 31, 35, 38, 42];

        document.addEventListener('DOMContentLoaded', function() {
            const lang = getCurrentLanguage();
            applyTranslations(lang);
            
            // Load booking details
            const booking = JSON.parse(localStorage.getItem('bookingDetails') || '{}');
            if (booking.from && booking.to) {
                document.getElementById('route-display').textContent = `${booking.from} â†’ ${booking.to}`;
                document.getElementById('date-display').textContent = booking.date || '2026-02-18';
                document.getElementById('time-display').textContent = booking.time || '10:00';
            }

            generateSeats();
        });

        function generateSeats() {
            const container = document.getElementById('seats-container');
            container.innerHTML = '';

            // Generate rows 1-10 (6 seats per row)
            for (let row = 1; row <= 10; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'seat-row';
                
                // 6 seats per row
                for (let col = 1; col <= 6; col++) {
                    const seatNumber = (row - 1) * 6 + col;
                    const seat = createSeat(seatNumber);
                    rowDiv.appendChild(seat);
                }
                
                container.appendChild(rowDiv);
            }

            // Back row (5 seats)
            const backRowDiv = document.createElement('div');
            backRowDiv.className = 'seat-row back-row';
            
            // Add label for back row
            const backLabel = document.createElement('div');
            backLabel.className = 'back-row-label';
            backLabel.textContent = 'BACK ROW';
            container.appendChild(backLabel);
            
            // 5 seats in back row
            for (let col = 1; col <= 5; col++) {
                const seatNumber = 60 + col; // Seats 61-65
                const seat = createSeat(seatNumber);
                backRowDiv.appendChild(seat);
            }
            
            container.appendChild(backRowDiv);
        }

        function createSeat(seatNumber) {
            const seat = document.createElement('div');
            seat.className = 'seat-number';
            seat.textContent = seatNumber;
            
            if (occupiedSeats.includes(seatNumber)) {
                seat.classList.add('occupied');
            } else {
                seat.classList.add('available');
                seat.onclick = () => toggleSeat(seatNumber, seat);
            }
            
            return seat;
        }

        function toggleSeat(seatNumber, element) {
            if (selectedSeats.has(seatNumber)) {
                // Deselect
                selectedSeats.delete(seatNumber);
                element.classList.remove('selected');
                element.classList.add('available');
            } else {
                // Select (only if not occupied)
                if (!occupiedSeats.includes(seatNumber)) {
                    selectedSeats.add(seatNumber);
                    element.classList.remove('available');
                    element.classList.add('selected');
                }
            }
            
            updateSelectionSummary();
        }

        function updateSelectionSummary() {
            const count = selectedSeats.size;
            const total = count * pricePerSeat;
            
            // Update summary text
            document.getElementById('selection-summary').textContent = 
                `Selected: ${count} seat${count !== 1 ? 's' : ''} | Total: ${total} BWP`;
            
            // Enable/disable proceed button
            document.getElementById('proceed-btn').disabled = count === 0;
            
            // Save to localStorage
            const booking = JSON.parse(localStorage.getItem('bookingDetails') || '{}');
            booking.selectedSeats = Array.from(selectedSeats);
            booking.totalPrice = total;
            localStorage.setItem('bookingDetails', JSON.stringify(booking));
        }

        function proceedToPayment() {
            if (selectedSeats.size > 0) {
                window.location.href = 'payment.html';
            }
        }
    </script>
</body>
                        </html>
